<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>World of Jars</title>
    <link rel="stylesheet" href="./styles.css" />
    <link
      href="https://fonts.googleapis.com/css?family=Nunito:400,600,700"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link
      href="https://unpkg.com/gridjs/dist/theme/mermaid.min.css"
      rel="stylesheet"
    />

    <!-- CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.8.1/firebase.js"></script>

    <!-- This is for toast messages-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="/js/jquery.toaster.js"></script>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light sticky-top" id="nav-bar">
      <a class="navbar-brand" style="font-size: 3em" href="#">World of Jars</a>
      </button>
      <button id="logout-btn" onclick="logout()">Logout</button>
    </nav>
    <section id="inventory-home-link">
      <div id="welcomeMessage"></div>
      <div class="links">
        <a href="addData.html">Add Data</a>
        <a href="viewData.html">View Data</a>
        <a href="modifyData.html">Modify Data</a>
        <a href="reports.html">Get Reports</a>
      </div>
    </section>

    <script src="./js/login.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const authToken = localStorage.getItem("authToken");
        const username = localStorage.getItem("username");

        // Redirect to index.html if not logged in (authToken is missing)
        if (!authToken) {
          localStorage.setItem("redirected", "true"); // Set a flag
          window.location.href = "/index.html";
          toastr.message(
            " Access DENIED! Please login to access the inventory page"
          );
          return; // Stop further execution
        }

        // If logged in, display a personalized welcome message
        if (username) {
          document.getElementById(
            "welcomeMessage"
          ).innerHTML = `Hi, welcome ${username}!`;
        } else {
          // If the username is somehow missing, you can choose to still display a generic welcome,
          // or consider re-fetching user details, or log the user out for inconsistency
          document.getElementById("welcomeMessage").innerHTML = "Hi, welcome!";
        }
      });
    </script>
  </body>
</html>
